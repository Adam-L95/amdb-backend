(this.webpackJsonpamdb=this.webpackJsonpamdb||[]).push([[0],{58:function(e,t,a){e.exports=a(87)},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(25),c=a.n(l),o=a(9),i=a.n(o),u=a(18),s=a(5),m=a(93),d=a(52),p=a(6),h=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(p.f)();return r.a.createElement(m.a,{inline:!0,onSubmit:function(e){e.preventDefault();var t=a.replace(/\s+/g,"+");c.push("/search/".concat(t)),c.push("/temp"),c.goBack(),l("")}},r.a.createElement(m.a.Control,{className:" mr-sm-2",type:"text",id:"search-bar",value:a,placeholder:"Search Movies...",onChange:function(e){l(e.target.value)}}),r.a.createElement(d.a,{variant:"primary",type:"submit"},"Search"))},v=a(94),E=a(95),f=a(7),g=function(e){return r.a.createElement("div",null,r.a.createElement(v.a,{bg:"dark",expand:"lg",variant:"dark"},r.a.createElement(f.b,{to:"/",className:"navbar-brand"},"AMDb"),r.a.createElement(v.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(v.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(E.a,{className:"mr-auto"},e.user?r.a.createElement(f.b,{to:"/watchlist",className:"nav-link"},"Watchlist (",e.watchlist.length,")"):null,e.user?r.a.createElement(f.b,{to:"/diary",className:"nav-link"},"Diary (",e.diary.length,")"):null),r.a.createElement(E.a,null,e.user?r.a.createElement("div",{className:"nav-link"},e.user.username):r.a.createElement(f.b,{className:"nav-link",to:"/login"},"login"),e.user?r.a.createElement(E.a.Link,{onClick:e.handleLogout},"Log out"):null)),r.a.createElement(h,null)))},b=function(e){var t=e.title,a=e.release_date,n=e.poster_path,l=e.id;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(f.b,{to:"/movies/".concat(l),className:"td"},function(e){if(e)return r.a.createElement("img",{src:"http://image.tmdb.org/t/p/w92/".concat(e),alt:"movie #".concat(l," poster")})}(n),t," (",a?a.split("-")[0]:"unreleased",")")))},w=a(11),y=a.n(w),O="/api/search",j=function(){return y.a.get("".concat(O,"/movie/now_playing")).then((function(e){return e.data.results}))},k=function(e){return y.a.get("".concat(O,"/movie/").concat(e)).then((function(e){return e.data}))},_=function(e){var t="".concat(O,"/").concat(e.replace(/\s+/g,"+"));return y.a.get(t).then((function(e){return e.data.results}))},C=function(e){return y.a.get("".concat(O,"/movie/credits/").concat(e)).then((function(e){return e.data}))},S=function(e){return y.a.get("".concat(O,"/movie/similar_movies/").concat(e)).then((function(e){return e.data.results}))},D=a(89),N=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(p.g)().searchTerm;return Object(n.useEffect)((function(){_(c).then((function(e){return l(e)}))}),[]),0!==a.length?r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h4",null,"Results for '",c.replaceAll("+"," "),"':"),r.a.createElement("br",null),r.a.createElement(D.a,{striped:!0},r.a.createElement("tbody",null,a.sort((function(e,t){return e.popularity<t.popularity?1:e.popularity>t.popularity?-1:0})).map((function(e){return r.a.createElement(b,{key:e.id,title:e.title,release_date:e.release_date,poster_path:e.poster_path,id:e.id})}))))):r.a.createElement("div",null,r.a.createElement("h4",null,"No Results"),"No results were found for your search term")},x="/api/userServices",I=null,L={addToWatchlist:function(){var e=Object(u.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:I}},e.next=3,y.a.post("".concat(x,"/watchlist"),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){I="bearer ".concat(e)},removeFromWatchlist:function(e){var t={headers:{Authorization:I}};return y.a.delete("".concat(x,"/watchlist/").concat(e),t)},addToDiary:function(){var e=Object(u.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:I}},e.next=3,y.a.post("".concat(x,"/diary"),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(e){var t=e.id,a=e.title,n=e.poster_path,l=e.release_date,c=e.watchlist,o=e.setWatchlist,i=e.setNotify,u=e.setError;return c.filter((function(e){return e.movieId===t})).length>0?r.a.createElement("div",null,r.a.createElement(d.a,{variant:"outline-danger",onClick:function(e){e.preventDefault(),u("'".concat(a,"' has been removed from your watchlist")),setTimeout((function(){u(null)}),3e3),L.removeFromWatchlist(t).then((function(e){o(e.data)}))}},"remove from watchlist")):r.a.createElement("div",null,r.a.createElement(d.a,{variant:"outline-primary",onClick:function(e){e.preventDefault();var r={id:t,title:a,poster_path:n,release_date:l};i("'".concat(a,"' added to watchlist")),setTimeout((function(){i(null)}),3e3),L.addToWatchlist(r).then((function(e){o(e)}))}},"add to watchlist"))},z=function(e){var t=e.id,a=e.title,n=e.poster_path,l=e.release_date,c=e.setWatchlist,o=e.setDiary,i=(e.setNotify,function(){L.removeFromWatchlist(t).then((function(e){c(e.data)}))});return r.a.createElement("div",null,r.a.createElement(d.a,{variant:"success",onClick:function(e){e.preventDefault();var r={id:t,title:a,poster_path:n,release_date:l};L.addToDiary(r).then((function(e){o(e),i()}))}},"Log film"))},M=a(97),W=function(e){var t=e.movie,a=e.cardSize,n=e.showCaption;return r.a.createElement(f.b,{to:"/movies/".concat(t.id),className:"card",style:{width:a}},r.a.createElement(M.a.Img,{variant:"top",src:"http://image.tmdb.org/t/p/w185/".concat(t.poster_path)}),n?r.a.createElement(M.a.Body,null,r.a.createElement(M.a.Title,null,t.title," (",t.release_date?t.release_date.split("-")[0]:"unreleased",")")):null)},A=a(98),P=a(90),U=a(91),J=a(92),F=function(e){var t=e.watchlist,a=e.setWatchlist,l=e.setDiary,c=e.setNotifyMessage,o=e.setErrorMessage,i=e.user,u=Object(n.useState)({}),m=Object(s.a)(u,2),h=m[0],v=m[1],E=Object(n.useState)({}),f=Object(s.a)(E,2),g=f[0],b=f[1],w=Object(n.useState)("cast"),y=Object(s.a)(w,2),O=y[0],j=y[1],_=Object(n.useState)(!1),D=Object(s.a)(_,2),N=D[0],x=D[1],I=Object(n.useState)([]),L=Object(s.a)(I,2),M=L[0],F=L[1],B=Object(p.g)().id,G=Object(p.f)();Object(n.useEffect)((function(){j("cast"),k(B).then((function(e){v(e)})),C(B).then((function(e){b(e)})),S(B).then((function(e){F(e)}))}),[B]);var R=function(e){e.preventDefault(),x(!N)},Y=function(){return g.cast?g.cast.length>10&&!N?r.a.createElement(A.a,null,g.cast.slice(0,10).map((function(e){return r.a.createElement(A.a.Item,{key:e.id},e.name," ... ",e.character)}))):r.a.createElement(A.a,null,g.cast.map((function(e){return r.a.createElement(A.a.Item,{key:e.id},e.name," ... ",e.character)}))):r.a.createElement("div",null,r.a.createElement(P.a,{animation:"border",size:"sm"}))},q=function(){return h?r.a.createElement(A.a,null,r.a.createElement(A.a.Item,null,"Release date: ",function(e){var t=new Date(e);return"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]," ").concat(t.getDate()," ").concat(t.getFullYear())}(h.release_date)),r.a.createElement(A.a.Item,null,r.a.createElement(A.a,null,r.a.createElement("div",null,"Country:"),h.production_countries.map((function(e){return r.a.createElement(A.a.Item,{key:e.name},e.name)})))),r.a.createElement(A.a.Item,null,r.a.createElement(A.a,null,r.a.createElement("div",null,"Language:"),h.spoken_languages.map((function(e){return r.a.createElement(A.a.Item,{key:e.iso_639_1},e.name?e.name:e.iso_639_1)}))))):r.a.createElement("div",null,r.a.createElement(P.a,{animation:"border",size:"sm"}))};return h&&g.crew?r.a.createElement("div",null,0!==g.crew.length?r.a.createElement("div",null,r.a.createElement("h2",null,h.title," (",h.release_date?h.release_date.split("-")[0]:"unreleased",")"),r.a.createElement("div",null,"Directed by ",g.crew.filter((function(e){return"Director"===e.job}))[0].name),r.a.createElement("img",{src:"http://image.tmdb.org/t/p/w185/".concat(h.poster_path),alt:"poster"})):r.a.createElement("div",null,r.a.createElement("h2",null,h.title," (",h.release_date?h.release_date.split("-")[0]:"unreleased",")"),r.a.createElement("img",{src:"http://image.tmdb.org/t/p/w185/".concat(h.poster_path),alt:"poster"})),h.overview?r.a.createElement("div",null,r.a.createElement("h5",null,h.tagline),r.a.createElement("p",null,h.overview),r.a.createElement("p",null,"runtime: ",h.runtime," minutes"),r.a.createElement("p",null,"more details at ",r.a.createElement(d.a,{href:"https://www.imdb.com/title/".concat(h.imdb_id),variant:"outline-secondary",size:"sm"},"IMDb"))):r.a.createElement("div",null,r.a.createElement(P.a,{animation:"border",size:"sm"})),i?r.a.createElement("div",null,r.a.createElement(z,{id:h.id,title:h.title,poster_path:h.poster_path,release_date:h.release_date,watchlist:t,setWatchlist:a,setDiary:l,setNotify:c}),r.a.createElement(T,{id:h.id,title:h.title,poster_path:h.poster_path,release_date:h.release_date,watchlist:t,setWatchlist:a,setNotify:c,setError:o})):r.a.createElement("div",null,r.a.createElement(d.a,{onClick:function(e){e.preventDefault(),G.push("/login")},variant:"outline-secondary"},"Log in to review and add to watchlist")),r.a.createElement(U.a,{toggle:!0},[{name:"Cast",value:"cast"},{name:"Crew",value:"crew"},{name:"Details",value:"details"},{name:"Genre",value:"genre"},{name:"Similar",value:"similar"}].map((function(e,t){return r.a.createElement(J.a,{key:t,type:"radio",variant:"secondary",name:"radio",value:e.value,checked:O===e.value,onChange:(a=e.value,function(e){e.preventDefault(),x(!1),j(a)})},e.name);var a}))),"cast"===O?g.cast&&g.cast.length>10?r.a.createElement("div",null,Y(),N?r.a.createElement(d.a,{onClick:R},"show less"):r.a.createElement(d.a,{onClick:R},"show all")):r.a.createElement("div",null,Y()):"crew"===O?g.crew?r.a.createElement(A.a,null,g.crew.slice(0,20).map((function(e){return r.a.createElement(A.a.Item,{key:e.credit_id},e.job," ... ",e.name)}))):r.a.createElement("div",null,r.a.createElement(P.a,{animation:"border",size:"sm"})):"details"===O?r.a.createElement("div",null,q()):"genre"===O?h.genres?r.a.createElement(A.a,null,h.genres.map((function(e){return r.a.createElement(A.a.Item,{key:e.id},e.name)}))):r.a.createElement("div",null,r.a.createElement(P.a,{animation:"border",size:"sm"})):"similar"===O?function(){if(M.length>0)return r.a.createElement(A.a,{horizontal:!0},M.slice(0,8).map((function(e){return r.a.createElement(W,{className:"list-group-item",key:e.id,movie:e,cardSize:"8rem",showCaption:!1})})))}():void 0):r.a.createElement("div",null)},B=function(e){var t=e.watchlist;return r.a.createElement("div",null,r.a.createElement("h3",null,"Your Watchlist"),r.a.createElement(A.a,null,t.map((function(e){return r.a.createElement(f.b,{className:"list-group-item-action",key:e.movieId,to:"/movies/".concat(e.movieId)},function(e){if(e)return r.a.createElement("img",{src:"http://image.tmdb.org/t/p/w92/".concat(e),alt:"poster"})}(e.posterPath),r.a.createElement("h3",null,e.title," (",e.releaseDate?e.releaseDate.split("-")[0]:"unreleased",") "))}))))},G=function(e){var t=e.diary,a=function(e){return e.split(" ")};return r.a.createElement(A.a,null,t.sort((function(e,t){return Date.parse(t.dateLogged)-Date.parse(e.dateLogged)})).map((function(e){return r.a.createElement(f.b,{className:"list-group-item-action",key:e._id,to:"/movies/".concat(e.movieId)},r.a.createElement("p",null,"Watched: ","".concat(a(e.dateLogged)[1]," ").concat(a(e.dateLogged)[2]," ").concat(a(e.dateLogged)[3])),function(e){if(e)return r.a.createElement("img",{src:"http://image.tmdb.org/t/p/w92/".concat(e),alt:"poster"})}(e.posterPath),r.a.createElement("h3",null,e.title," (",e.releaseDate?e.releaseDate.split("-")[0]:"unreleased",") "))})))},R=a(96),Y=function(e){var t=e.message;return null===t?null:r.a.createElement(R.a,{variant:"success"},t)},q=function(e){var t=e.message;return null===t?null:r.a.createElement(R.a,{variant:"danger"},t)},H=function(e){return r.a.createElement("div",null,r.a.createElement(m.a,{onSubmit:e.handleSubmit},r.a.createElement(m.a.Group,null,r.a.createElement(m.a.Label,null,"username:"),r.a.createElement(m.a.Control,{type:"text",id:"username",value:e.username,name:"Username",onChange:e.handleUsernameChange}),r.a.createElement(m.a.Label,null,"password:"),r.a.createElement(m.a.Control,{type:"password",id:"password",value:e.password,name:"Password",onChange:e.handlePasswordChange}),r.a.createElement(d.a,{variant:"primary",id:"login-button",type:"submit"},"login"))))},K=function(e){return r.a.createElement("div",null,r.a.createElement(m.a,{onSubmit:e.handleSubmit},r.a.createElement(m.a.Group,null,r.a.createElement(m.a.Label,null,"username:"),r.a.createElement(m.a.Control,{type:"text",id:"username",value:e.username,name:"Username",onChange:e.handleUsernameChange}),r.a.createElement(m.a.Label,null,"name:"),r.a.createElement(m.a.Control,{type:"text",id:"name",value:e.name,name:"Name",onChange:e.handleNameChange}),r.a.createElement(m.a.Label,null,"password:"),r.a.createElement(m.a.Control,{type:"password",id:"password",value:e.password,name:"Password",onChange:e.handlePasswordChange}),r.a.createElement(m.a.Label,null,"confirm password:"),r.a.createElement(m.a.Control,{type:"password",id:"password2",value:e.password2,name:"Password2",onChange:e.handlePassword2Change}),r.a.createElement(d.a,{variant:"primary",id:"login-button",type:"submit"},"Create Account"))))},Q=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],l=t[1],c=0;return c="undefined"!==typeof window.orientation?3:6,Object(n.useEffect)((function(){j().then((function(e){return l(e)}))}),[]),a.length>0?r.a.createElement("div",null,r.a.createElement("h3",null,"Now Playing: "),r.a.createElement("br",null),r.a.createElement(A.a,{horizontal:!0},a.sort((function(e,t){return e.vote_count<t.vote_count?1:e.vote_count>t.vote_count?-1:0})).slice(0,c).map((function(e){return r.a.createElement(W,{movie:e,cardSize:"18rem",key:e.id,showCaption:!0})})))):null},V={login:function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},X={createUser:function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/users",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Z=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)([]),o=Object(s.a)(c,2),m=o[0],d=o[1],h=Object(n.useState)([]),v=Object(s.a)(h,2),E=v[0],b=v[1],w=Object(n.useState)(""),y=Object(s.a)(w,2),O=y[0],j=y[1],k=Object(n.useState)(""),_=Object(s.a)(k,2),C=_[0],S=_[1],D=Object(n.useState)(""),x=Object(s.a)(D,2),I=x[0],T=x[1],z=Object(n.useState)(""),M=Object(s.a)(z,2),W=M[0],A=M[1],P=Object(n.useState)(null),U=Object(s.a)(P,2),J=U[0],R=U[1],Z=Object(n.useState)(null),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ae=Object(p.f)();Object(n.useEffect)((function(){var e=window.localStorage.getItem("loggedMovieAppUser");if(e){var t=JSON.parse(e);l(t),L.setToken(t.token),d(t.watchlist),b(t.diary)}}),[]);var ne=function(e){window.localStorage.setItem("loggedMovieAppUser",JSON.stringify(e)),L.setToken(e.token),l(e),d(e.watchlist),b(e.diary),j(""),S(""),T(""),A(""),ae.push("/"),te("welcome ".concat(e.name)),setTimeout((function(){te(null)}),5e3)},re=function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,V.login({username:O,password:C});case 4:a=e.sent,ne(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),R("Invalid username or password"),setTimeout((function(){R(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C===I){e.next=8;break}R("the passwords do not match"),S(""),T(""),setTimeout((function(){R(null)}),5e3),e.next=22;break;case 8:return e.prev=8,e.next=11,X.createUser({username:O,name:W,password:C});case 11:return e.next=13,V.login({username:O,password:C});case 13:a=e.sent,ne(a),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(8),R("User already exists"),console.log(e.t0.message),setTimeout((function(){R(null)}),5e3);case 22:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement(g,{user:a,watchlist:m,diary:E,handleLogout:function(e){e.preventDefault(),window.localStorage.removeItem("loggedMovieAppUser"),ae.push("/"),window.location.reload()}}),r.a.createElement(Y,{message:ee}),r.a.createElement(q,{message:J}),r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/login"},r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement(q,{message:J}),r.a.createElement(H,{username:O,password:C,handleUsernameChange:function(e){var t=e.target;return j(t.value)},handlePasswordChange:function(e){var t=e.target;return S(t.value)},handleSubmit:re}),r.a.createElement(f.b,{to:"/create-account"},"Create an account"))),r.a.createElement(p.a,{path:"/create-account"},r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Create an account"),r.a.createElement(q,{message:J}),r.a.createElement(K,{username:O,password:C,password2:I,name:W,handleUsernameChange:function(e){var t=e.target;return j(t.value)},handleNameChange:function(e){var t=e.target;return A(t.value)},handlePasswordChange:function(e){var t=e.target;return S(t.value)},handlePassword2Change:function(e){var t=e.target;return T(t.value)},handleSubmit:le}))),r.a.createElement(p.a,{path:"/movies/:id"},r.a.createElement(F,{user:a,watchlist:m,setWatchlist:d,setDiary:b,setNotifyMessage:te,setErrorMessage:R})),r.a.createElement(p.a,{path:"/watchlist"},r.a.createElement(B,{watchlist:m,username:O})),r.a.createElement(p.a,{path:"/diary"},r.a.createElement(G,{diary:E})),r.a.createElement(p.a,{path:"/search/:searchTerm"},r.a.createElement(N,null)),r.a.createElement(p.a,{path:"/"},r.a.createElement(Q,null))),r.a.createElement("footer",null,r.a.createElement("br",null),r.a.createElement("em",null,"Adam Lapinski, 2020. Film data from ",r.a.createElement("a",{href:"https://www.themoviedb.org/"},"TMDb"))))};c.a.render(r.a.createElement(f.a,null,r.a.createElement(Z,null)),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.fb0310c9.chunk.js.map